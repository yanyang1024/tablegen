# æ•°æ®è¡¨æ ¼å¡«å…… Demo

ä¸€ä¸ªåŸºäº Streamlit çš„æ•°æ®å¤„ç†å’Œè¡¨æ ¼ç”Ÿæˆåº”ç”¨ï¼Œæ”¯æŒä¸¤æ­¥å¼æ•°æ®å¤„ç†æµç¨‹ï¼šå…ˆç”Ÿæˆä¸­é—´ç»“æœï¼Œå†åŸºäºä¸­é—´ç»“æœå’Œå‚æ•°ç”Ÿæˆæœ€ç»ˆè¡¨æ ¼ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.9+
- Streamlit 1.37.0+
- Pandas 2.2.2+
- OpenPyXL 3.1.2+

### å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### è¿è¡Œåº”ç”¨
```bash
streamlit run app.py
```

åº”ç”¨å°†åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼šhttp://localhost:8501

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### 1. é€‰æ‹©æˆ–ä¸Šä¼ æ¨¡æ¿
- **ä½¿ç”¨é»˜è®¤æ¨¡æ¿**ï¼šåœ¨ä¾§è¾¹æ è°ƒæ•´è¡Œæ•°å’Œåˆ—æ•°
- **ä¸Šä¼ è‡ªå®šä¹‰æ¨¡æ¿**ï¼šæ”¯æŒ CSV å’Œ Excel æ–‡ä»¶
  - ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—å°†ä½œä¸ºå‚è€ƒä¿¡æ¯ä¿ç•™
  - å…¶ä»–éƒ¨åˆ†ä¼šè‡ªåŠ¨å¡«å……ä¸ºå ä½ç¬¦

### 2. è¾“å…¥äº”æ®µæ–‡æœ¬
åœ¨äº”ä¸ªæ–‡æœ¬æ¡†ä¸­è¾“å…¥éœ€è¦å¤„ç†çš„æ–‡æœ¬å†…å®¹ï¼š
- æ–‡æœ¬å— 1-5ï¼šæ”¯æŒä»»æ„é•¿åº¦çš„æ–‡æœ¬è¾“å…¥

### 3. ç”Ÿæˆä¸­é—´ç»“æœ
ç‚¹å‡»"ç”Ÿæˆä¸­é—´ç»“æœ"æŒ‰é’®ï¼š
- ç³»ç»Ÿå°†äº”æ®µæ–‡æœ¬æŒ‰ç©ºç™½åˆ†è¯
- ç”ŸæˆåŒ…å« `source`ã€`index`ã€`token` ä¸‰åˆ—çš„ä¸­é—´ç»“æœè¡¨
- è¡¨æ ¼è¡Œæ•°æ ¹æ®å®é™…åˆ†è¯ç»“æœè‡ªé€‚åº”

### 4. è¾“å…¥ä¸­é—´é˜¶æ®µå‚æ•°
åœ¨"ä¸­é—´é˜¶æ®µå‚æ•°"è¾“å…¥æ¡†ä¸­è¾“å…¥é¢å¤–å‚æ•°å€¼

### 5. ç”Ÿæˆæœ€ç»ˆç»“æœ
ç‚¹å‡»"ç”Ÿæˆæœ€ç»ˆç»“æœ"æŒ‰é’®ï¼š
- åŸºäºä¸­é—´ç»“æœè¡¨å’Œå‚æ•°å€¼ç”Ÿæˆæœ€ç»ˆè¡¨æ ¼
- ä¿æŒæ¨¡æ¿çš„é¦–è¡Œé¦–åˆ—ä¸å˜
- å…¶ä»–éƒ¨åˆ†æŒ‰è§„åˆ™å¡«å……å¤„ç†åçš„æ•°æ®

### 6. ä¸‹è½½ç»“æœ
- ä¸­é—´ç»“æœï¼šç‚¹å‡»"ä¸‹è½½ä¸­é—´ç»“æœ CSV"
- æœ€ç»ˆç»“æœï¼šç‚¹å‡»"ä¸‹è½½æœ€ç»ˆç»“æœ CSV"

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
data_table_demo93/
â”œâ”€â”€ app.py                 # Streamlit ä¸»åº”ç”¨å…¥å£
â”œâ”€â”€ config.py              # é…ç½®å‚æ•°ç®¡ç†
â”œâ”€â”€ data_handler.py        # æ•°æ®å¤„ç†æ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ templates/             # æ¨¡æ¿æ–‡ä»¶ç›®å½•
â”œâ”€â”€ output/                # è¾“å‡ºæ–‡ä»¶ç›®å½•
â”œâ”€â”€ requirements.txt       # Python ä¾èµ–
â””â”€â”€ README.md             # é¡¹ç›®æ–‡æ¡£
```

## âš™ï¸ é…ç½®è¯´æ˜

### config.py ä¸»è¦å‚æ•°

```python
@dataclass
class Config:
    # æ–‡æœ¬è¾“å…¥é»˜è®¤å€¼
    default_text1: str = "hello"
    default_text2: str = "world"
    default_text3: str = "foo"
    default_text4: str = "bar"
    default_text5: str = "baz"
    
    # ä¸­é—´é˜¶æ®µå‚æ•°é»˜è®¤å€¼
    default_mid_param: str = "param"
    
    # è¡¨æ ¼å°ºå¯¸
    rows: int = 5
    cols: int = 4
    
    # å ä½ç¬¦
    placeholder: str = "å¾…å¡«å……"
```

## ğŸ”§ äºŒæ¬¡å¼€å‘æŒ‡å—

### 1. ä¿®æ”¹æ•°æ®å¤„ç†é€»è¾‘

#### ä¸­é—´ç»“æœç”Ÿæˆé€»è¾‘
ç¼–è¾‘ `data_handler.py` ä¸­çš„ `generate_intermediate_result` å‡½æ•°ï¼š

```python
def generate_intermediate_result(text1: str, text2: str, text3: str, text4: str, text5: str) -> pd.DataFrame:
    """
    è‡ªå®šä¹‰ä¸­é—´ç»“æœç”Ÿæˆé€»è¾‘
    """
    # åœ¨è¿™é‡Œå®ç°ä½ çš„æ–‡æœ¬å¤„ç†é€»è¾‘
    # ä¾‹å¦‚ï¼šæ–‡æœ¬åˆ†æã€ç‰¹å¾æå–ã€æ•°æ®æ¸…æ´—ç­‰
    
    # è¿”å› DataFrameï¼Œåˆ—æ•°å’Œè¡Œæ•°å¯è‡ªé€‚åº”
    return your_custom_dataframe
```

#### æœ€ç»ˆç»“æœç”Ÿæˆé€»è¾‘
ç¼–è¾‘ `data_handler.py` ä¸­çš„ `process_intermediate_to_final` å‡½æ•°ï¼š

```python
def process_intermediate_to_final(df_mid: pd.DataFrame, mid_param: str, df_template: pd.DataFrame, rows: int, cols: int) -> pd.DataFrame:
    """
    è‡ªå®šä¹‰æœ€ç»ˆç»“æœç”Ÿæˆé€»è¾‘
    """
    # åœ¨è¿™é‡Œå®ç°åŸºäºä¸­é—´ç»“æœå’Œå‚æ•°çš„æœ€ç»ˆè¡¨æ ¼ç”Ÿæˆé€»è¾‘
    # df_mid: ä¸­é—´ç»“æœè¡¨
    # mid_param: ä¸­é—´é˜¶æ®µå‚æ•°
    # df_template: æ¨¡æ¿è¡¨æ ¼
    # rows, cols: ç›®æ ‡è¡¨æ ¼å°ºå¯¸
    
    # è¿”å›å¡«å……åçš„æœ€ç»ˆè¡¨æ ¼
    return your_final_dataframe
```

### 2. æ·»åŠ æ–°çš„é…ç½®å‚æ•°

åœ¨ `config.py` ä¸­æ·»åŠ æ–°çš„é…ç½®é¡¹ï¼š

```python
@dataclass
class Config:
    # ç°æœ‰é…ç½®...
    
    # æ–°å¢é…ç½®
    new_parameter: str = "default_value"
    numeric_param: int = 100
    list_param: list = None
```

åœ¨ `app.py` ä¸­ä½¿ç”¨æ–°é…ç½®ï¼š

```python
# åœ¨ä¾§è¾¹æ æˆ–å…¶ä»–ä½ç½®æ·»åŠ æ§ä»¶
new_value = st.text_input("æ–°å‚æ•°", cfg.new_parameter)
```

### 3. ä¿®æ”¹ç•Œé¢å¸ƒå±€

#### æ·»åŠ æ–°çš„è¾“å…¥æ§ä»¶
```python
# åœ¨ app.py ä¸­æ·»åŠ æ–°çš„è¾“å…¥æ§ä»¶
new_input = st.text_area("æ–°è¾“å…¥æ¡†", height=80)
new_select = st.selectbox("é€‰æ‹©æ¡†", ["é€‰é¡¹1", "é€‰é¡¹2", "é€‰é¡¹3"])
new_slider = st.slider("æ•°å€¼æ»‘å—", 0, 100, 50)
```

#### æ·»åŠ æ–°çš„å±•ç¤ºåŒºåŸŸ
```python
# æ·»åŠ æ–°çš„ç»“æœå±•ç¤º
if st.button("æ–°åŠŸèƒ½æŒ‰é’®"):
    new_result = your_new_function()
    st.subheader("æ–°ç»“æœ")
    st.dataframe(new_result)
```

### 4. æ‰©å±•æ•°æ®å¤„ç†åŠŸèƒ½

#### æ·»åŠ æ–°çš„æ•°æ®å¤„ç†å‡½æ•°
åœ¨ `data_handler.py` ä¸­æ·»åŠ æ–°å‡½æ•°ï¼š

```python
def your_new_data_processing_function(input_data, **kwargs):
    """
    æ–°çš„æ•°æ®å¤„ç†å‡½æ•°
    """
    # å®ç°ä½ çš„æ•°æ®å¤„ç†é€»è¾‘
    processed_data = process_data(input_data)
    return processed_data
```

#### é›†æˆå¤–éƒ¨åº“
åœ¨ `requirements.txt` ä¸­æ·»åŠ æ–°çš„ä¾èµ–ï¼š

```
# ç°æœ‰ä¾èµ–...
numpy==1.24.0
scikit-learn==1.3.0
matplotlib==3.7.0
```

### 5. è‡ªå®šä¹‰æ¨¡æ¿å¤„ç†

#### æ”¯æŒæ–°çš„æ–‡ä»¶æ ¼å¼
åœ¨ `create_template_from_upload` å‡½æ•°ä¸­æ·»åŠ æ–°æ ¼å¼æ”¯æŒï¼š

```python
def create_template_from_upload(uploaded_file):
    try:
        if uploaded_file.name.endswith(".csv"):
            df = pd.read_csv(uploaded_file)
        elif uploaded_file.name.endswith(".xlsx"):
            df = pd.read_excel(uploaded_file, engine="openpyxl")
        elif uploaded_file.name.endswith(".json"):  # æ–°å¢ JSON æ”¯æŒ
            df = pd.read_json(uploaded_file)
        else:
            raise ValueError("ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼")
        
        # åç»­å¤„ç†é€»è¾‘...
```

## ğŸ§ª æµ‹è¯•å’Œè°ƒè¯•

### è¿è¡Œæµ‹è¯•
```bash
python test_app.py
```

### è°ƒè¯•æŠ€å·§
1. ä½¿ç”¨ `st.write()` è¾“å‡ºè°ƒè¯•ä¿¡æ¯
2. åœ¨å…³é”®ä½ç½®æ·»åŠ  `st.info()` æ˜¾ç¤ºçŠ¶æ€
3. ä½¿ç”¨ `st.exception()` æ•è·å’Œæ˜¾ç¤ºé”™è¯¯

### æ€§èƒ½ä¼˜åŒ–
1. å¤§æ•°æ®é›†å¤„ç†æ—¶ä½¿ç”¨åˆ†é¡µæ˜¾ç¤º
2. å¤æ‚è®¡ç®—ä½¿ç”¨ `@st.cache_data` ç¼“å­˜
3. é¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡å¤è®¡ç®—

## ğŸ“ å¸¸è§é—®é¢˜

### Q: ä¸Šä¼ çš„ Excel æ–‡ä»¶æ— æ³•è¯»å–
A: ç¡®ä¿å®‰è£…äº† `openpyxl` åº“ï¼š`pip install openpyxl`

### Q: è¡¨æ ¼æ˜¾ç¤ºå¼‚å¸¸æˆ–æŠ¥é”™
A: æ£€æŸ¥æ•°æ®ç±»å‹å…¼å®¹æ€§ï¼Œç¡®ä¿éé¦–åˆ—å·²è½¬æ¢ä¸º string ç±»å‹

### Q: ä¸­é—´ç»“æœè¡¨æ ¼ä¸ºç©º
A: æ£€æŸ¥è¾“å…¥æ–‡æœ¬æ˜¯å¦åŒ…å«æœ‰æ•ˆå†…å®¹ï¼Œç©ºæ–‡æœ¬æˆ–çº¯ç©ºæ ¼ä¼šå¯¼è‡´æ— ç»“æœ

### Q: æœ€ç»ˆç»“æœå¡«å……ä¸å®Œæ•´
A: æ£€æŸ¥æ¨¡æ¿å°ºå¯¸è®¾ç½®ï¼Œç¡®ä¿è¡Œåˆ—æ•°è¶³å¤Ÿå®¹çº³æ‰€æœ‰æ•°æ®

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue
- å‘é€é‚®ä»¶
- é¡¹ç›®è®¨è®ºåŒº

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰è¯·è¿›è¡Œå……åˆ†æµ‹è¯•å’Œå®‰å…¨å®¡æŸ¥ã€‚ 